<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>EmberMate - Personal Health Management</title>
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self';
             img-src 'self' data:;
             style-src 'self' 'unsafe-inline' https://vercel.live;
             script-src 'self' 'unsafe-inline' https://vercel.live;
             connect-src 'self' https://vercel.live;
             font-src 'self' data:;
             frame-ancestors 'none';
             base-uri 'self';
             form-action 'self'">
  <style>
    /* Modern Design System */
    :root {
      --primary-color: #3b82f6;
      --primary-dark: #1e40af;
      --secondary-color: #10b981;
      --accent-color: #f59e0b;
      --danger-color: #ef4444;
      --success-color: #22c55e;
      --warning-color: #f59e0b;
      --info-color: #06b6d4;
      
      --bg-primary: #0f172a;
      --bg-secondary: #1e293b;
      --bg-tertiary: #334155;
      --bg-card: #1e293b;
      --bg-hover: #334155;
      
      --text-primary: #f8fafc;
      --text-secondary: #cbd5e1;
      --text-muted: #94a3b8;
      
      --border-color: #334155;
      --border-light: #475569;
      
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      
      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
      
      --spacing-xs: 0.25rem;
      --spacing-sm: 0.5rem;
      --spacing-md: 1rem;
      --spacing-lg: 1.5rem;
      --spacing-xl: 2rem;
      --spacing-2xl: 3rem;
    }
    
    /* Modern Typography */
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      color: var(--text-primary);
      background: var(--bg-primary);
      margin: 0;
      padding: 0;
    }
    
    h1, h2, h3, h4, h5, h6 {
      font-weight: 600;
      line-height: 1.3;
      color: var(--text-primary);
      margin: 0;
    }
    
    h1 { font-size: 2.25rem; }
    h2 { font-size: 1.875rem; }
    h3 { font-size: 1.5rem; }
    h4 { font-size: 1.25rem; }
    h5 { font-size: 1.125rem; }
    h6 { font-size: 1rem; }
    
    /* Modern Layout */
    .layout {
      display: flex;
      min-height: 100vh;
      background: var(--bg-primary);
    }
    
    .sidenav {
      width: 280px;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      z-index: 100;
      transition: transform 0.3s ease;
    }
    
    .main {
      flex: 1;
      margin-left: 280px;
      padding: var(--spacing-xl);
      background: var(--bg-primary);
      min-height: 100vh;
    }
    
    /* Modern Navigation */
    .brand {
      padding: var(--spacing-lg);
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
    }
    
    .brand-icon {
      font-size: 1.5rem;
    }
    
    .sidenav ul {
      list-style: none;
      padding: var(--spacing-md);
      margin: 0;
    }
    
    .sidenav li {
      margin-bottom: var(--spacing-xs);
    }
    
    .sidenav a {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-sm) var(--spacing-md);
      color: var(--text-secondary);
      text-decoration: none;
      border-radius: var(--radius-md);
      transition: all 0.2s ease;
      font-weight: 500;
    }
    
    .sidenav a:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
      transform: translateX(4px);
    }
    
    .sidenav a[aria-current="page"] {
      background: var(--primary-color);
      color: white;
      box-shadow: var(--shadow-md);
    }
    
    /* Modern Cards */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: var(--spacing-xl);
      box-shadow: var(--shadow-sm);
      transition: all 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
      border-color: var(--border-light);
    }
    
    /* Modern Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-sm) var(--spacing-md);
      border: none;
      border-radius: var(--radius-md);
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      box-shadow: var(--shadow-sm);
    }
    
    .btn-primary {
      background: var(--primary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }
    
    .btn-secondary {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }
    
    .btn-secondary:hover {
      background: var(--bg-hover);
      border-color: var(--border-light);
    }
    
    /* Modern Dashboard */
    .dashboard-header {
      margin-bottom: var(--spacing-xl);
    }
    
    .dashboard-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--spacing-sm);
    }
    
    .dashboard-subtitle {
      color: var(--text-secondary);
      font-size: 1.125rem;
    }
    
    /* Quick Actions */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-xl);
    }
    
    .quick-action {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--text-primary);
    }
    
    .quick-action:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
      border-color: var(--primary-color);
    }
    
    .quick-action-icon {
      font-size: 2rem;
      margin-bottom: var(--spacing-sm);
    }
    
    .quick-action-title {
      font-weight: 600;
      margin-bottom: var(--spacing-xs);
    }
    
    .quick-action-desc {
      font-size: 0.875rem;
      color: var(--text-secondary);
    }
    
    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-xl);
    }
    
    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }
    
    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: var(--spacing-sm);
    }
    
    .stat-label {
      color: var(--text-secondary);
      font-size: 0.875rem;
      font-weight: 500;
    }
    
    /* Mobile Responsive */
    @media (max-width: 768px) {
      .sidenav {
        transform: translateX(-100%);
        width: 100%;
      }
      
      .sidenav.open {
        transform: translateX(0);
      }
      
      .main {
        margin-left: 0;
        padding: var(--spacing-md);
      }
      
      .quick-actions {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .dashboard-title {
        font-size: 1.5rem;
      }
    }
    
    /* Micro-interactions */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideIn {
      from { transform: translateX(-20px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    .animate-fade-in {
      animation: fadeIn 0.6s ease-out;
    }
    
    .animate-slide-in {
      animation: slideIn 0.4s ease-out;
    }
    
    /* Loading States */
    .loading {
      opacity: 0.6;
      pointer-events: none;
    }
    
    .loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid var(--primary-color);
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Header Controls */
    .header-controls {
      position: fixed;
      top: var(--spacing-lg);
      right: var(--spacing-lg);
      display: flex;
      gap: var(--spacing-sm);
      z-index: 1000;
    }
    
    .header-btn {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: var(--spacing-sm);
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 1.2rem;
    }
    
    .header-btn:hover {
      background: var(--bg-hover);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay" style="display: none;">
    <div style="text-align: center; color: var(--text-primary);">
      <div style="font-size: 2rem; margin-bottom: var(--spacing-md);">💊</div>
      <div style="font-size: 1.25rem; font-weight: 600;">Loading EmberMate...</div>
      <div style="color: var(--text-secondary); margin-top: var(--spacing-sm);">Setting up your health dashboard</div>
    </div>
  </div>

  <!-- Header Controls -->
  <div class="header-controls">
    <button id="voice-toggle" class="header-btn" title="Voice Commands">
      🎤
    </button>
    <button id="theme-toggle" class="header-btn" title="Toggle Theme">
      🌙
    </button>
  </div>

  <div class="layout">
    <!-- Sidebar Navigation -->
    <nav class="sidenav" aria-label="Primary">
      <div class="brand">
        <span class="brand-icon">💊</span>
        <span>EmberMate</span>
      </div>
      
      <ul>
        <li><a href="#dashboard" data-nav aria-current="page">📊 Dashboard</a></li>
        <li><a href="#medications" data-nav>💊 Medications</a></li>
        <li><a href="#vitals" data-nav>❤️ Vitals</a></li>
        <li><a href="#weight" data-nav>⚖️ Weight</a></li>
        <li><a href="#symptoms" data-nav>🤒 Symptoms</a></li>
        <li><a href="#goals" data-nav>🎯 Goals</a></li>
        <li><a href="#reports" data-nav>📈 Reports</a></li>
        <li><a href="#settings" data-nav>⚙️ Settings</a></li>
      </ul>
      
      <div style="margin-top: auto; padding: var(--spacing-md);">
        <button class="btn btn-secondary" id="quick-export" style="width: 100%; margin-bottom: var(--spacing-sm);">
          📤 Export Data
        </button>
        <button class="btn btn-secondary" id="view-hipaa" style="width: 100%;">
          🔒 Privacy Notice
        </button>
      </div>
    </nav>

    <!-- Main Content -->
    <main id="main" class="main" role="main">
      <div id="app" style="display: block;">
        
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page" style="display: block;">
          <div class="dashboard-header animate-fade-in">
            <h1 class="dashboard-title">Welcome to EmberMate</h1>
            <p class="dashboard-subtitle">Your personal health management dashboard</p>
          </div>

          <!-- Quick Actions -->
          <div class="quick-actions animate-fade-in">
            <a href="#" class="quick-action" id="quick-add-vitals">
              <div class="quick-action-icon">❤️</div>
              <div class="quick-action-title">Add Vitals</div>
              <div class="quick-action-desc">Blood pressure, heart rate</div>
            </a>
            <a href="#" class="quick-action" id="quick-add-weight">
              <div class="quick-action-icon">⚖️</div>
              <div class="quick-action-title">Log Weight</div>
              <div class="quick-action-desc">Track your progress</div>
            </a>
            <a href="#" class="quick-action" id="quick-add-med">
              <div class="quick-action-icon">💊</div>
              <div class="quick-action-title">Log Medication</div>
              <div class="quick-action-desc">Mark as taken</div>
            </a>
            <a href="#" class="quick-action" id="quick-add-symptom">
              <div class="quick-action-icon">🤒</div>
              <div class="quick-action-title">Add Symptom</div>
              <div class="quick-action-desc">Track how you feel</div>
            </a>
          </div>

          <!-- Stats Overview -->
          <div class="stats-grid animate-fade-in">
            <div class="stat-card">
              <div class="stat-value" style="color: var(--primary-color);" id="stat-meds-today">0</div>
              <div class="stat-label">Medications Today</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" style="color: var(--success-color);" id="stat-bp-latest">--/--</div>
              <div class="stat-label">Latest BP</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" style="color: var(--accent-color);" id="stat-weight-latest">-- lbs</div>
              <div class="stat-label">Current Weight</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" style="color: var(--info-color);" id="stat-goals-progress">0%</div>
              <div class="stat-label">Goal Progress</div>
            </div>
          </div>

          <!-- Recent Activity -->
          <div class="card animate-fade-in">
            <h3 style="margin-bottom: var(--spacing-lg);">Recent Activity</h3>
            <div id="recent-activity" style="color: var(--text-secondary);">
              <p>No recent activity. Start by adding your first medication or vital signs!</p>
            </div>
          </div>
        </div>

        <!-- Other pages will be added here -->
        <div id="medications-page" class="page" style="display: none;">
          <div class="dashboard-header">
            <h1>Medications</h1>
            <p>Manage your medications and track adherence</p>
          </div>
          <div class="card">
            <p>Medication management coming soon...</p>
          </div>
        </div>

        <div id="vitals-page" class="page" style="display: none;">
          <div class="dashboard-header">
            <h1>Vitals</h1>
            <p>Track your vital signs and health metrics</p>
          </div>
          <div class="card">
            <p>Vitals tracking coming soon...</p>
          </div>
        </div>

        <div id="weight-page" class="page" style="display: none;">
          <div class="dashboard-header">
            <h1>Weight Tracking</h1>
            <p>Monitor your weight and BMI progress</p>
          </div>
          <div class="card">
            <p>Weight tracking coming soon...</p>
          </div>
        </div>

        <div id="symptoms-page" class="page" style="display: none;">
          <div class="dashboard-header">
            <h1>Symptoms</h1>
            <p>Log symptoms and side effects</p>
          </div>
          <div class="card">
            <p>Symptom tracking coming soon...</p>
          </div>
        </div>

        <div id="goals-page" class="page" style="display: none;">
          <div class="dashboard-header">
            <h1>Health Goals</h1>
            <p>Set and track your health objectives</p>
          </div>
          <div class="card">
            <p>Goal setting coming soon...</p>
          </div>
        </div>

        <div id="reports-page" class="page" style="display: none;">
          <div class="dashboard-header">
            <h1>Reports</h1>
            <p>Generate health reports and insights</p>
          </div>
          <div class="card">
            <p>Reports coming soon...</p>
          </div>
        </div>

        <div id="settings-page" class="page" style="display: none;">
          <div class="dashboard-header">
            <h1>Settings</h1>
            <p>Customize your EmberMate experience</p>
          </div>
          <div class="card">
            <p>Settings coming soon...</p>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Voice Interface -->
  <div id="voice-interface" style="display: none; position: fixed; bottom: var(--spacing-xl); left: 50%; transform: translateX(-50%); background: var(--bg-card); border: 1px solid var(--border-color); border-radius: var(--radius-lg); padding: var(--spacing-lg); box-shadow: var(--shadow-xl); z-index: 1000; min-width: 300px;">
    <div style="text-align: center; margin-bottom: var(--spacing-md);">
      <div id="voice-status" style="font-weight: 600; color: var(--text-primary);">🎤 Ready to Record</div>
      <div id="voice-transcript" style="color: var(--text-secondary); font-size: 0.875rem; margin-top: var(--spacing-sm);">Click the microphone button above to start recording</div>
    </div>
    <div style="display: flex; gap: var(--spacing-sm); justify-content: center;">
      <button id="voice-stop" class="btn btn-secondary">⏹️ Stop</button>
      <button id="voice-test" class="btn btn-secondary">🧪 Test</button>
      <button id="voice-help" class="btn btn-secondary">❓</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/app.js"></script>
  <script src="js/nav.js"></script>
  <script src="js/sampling.js"></script>
  <script src="js/consent.js"></script>
  <script src="js/telemetry.js"></script>
  <script src="js/app-enhanced.js"></script>

  <!-- Modern Navigation Script -->
  <script>
    // Modern navigation with smooth transitions
    document.addEventListener('DOMContentLoaded', function() {
      const navLinks = document.querySelectorAll('[data-nav]');
      const pages = document.querySelectorAll('.page');
      
      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Remove active class from all links
          navLinks.forEach(l => l.removeAttribute('aria-current'));
          
          // Add active class to clicked link
          this.setAttribute('aria-current', 'page');
          
          // Hide all pages
          pages.forEach(page => {
            page.style.display = 'none';
            page.classList.remove('animate-fade-in');
          });
          
          // Show target page with animation
          const targetPage = document.getElementById(this.getAttribute('href').substring(1) + '-page');
          if (targetPage) {
            targetPage.style.display = 'block';
            setTimeout(() => {
              targetPage.classList.add('animate-fade-in');
            }, 10);
          }
        });
      });
      
      // Mobile menu toggle
      const mobileMenuBtn = document.createElement('button');
      mobileMenuBtn.innerHTML = '☰';
      mobileMenuBtn.className = 'header-btn';
      mobileMenuBtn.style.display = 'none';
      mobileMenuBtn.onclick = () => {
        document.querySelector('.sidenav').classList.toggle('open');
      };
      
      document.querySelector('.header-controls').prepend(mobileMenuBtn);
      
      // Show mobile menu button on small screens
      if (window.innerWidth <= 768) {
        mobileMenuBtn.style.display = 'block';
      }
      
      window.addEventListener('resize', () => {
        if (window.innerWidth <= 768) {
          mobileMenuBtn.style.display = 'block';
        } else {
          mobileMenuBtn.style.display = 'none';
          document.querySelector('.sidenav').classList.remove('open');
        }
      });
    });
  </script>
</body>
</html>
