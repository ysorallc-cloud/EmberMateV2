<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>EmberMate - Personal Health Management</title>
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self';
             img-src 'self' data:;
             style-src 'self' 'unsafe-inline' https://vercel.live;
             script-src 'self' 'unsafe-inline' https://vercel.live;
             connect-src 'self' https://vercel.live;
             font-src 'self' data:;
             frame-ancestors 'none';
             base-uri 'self';
             form-action 'self'">
  <link rel="stylesheet" href="assets/styles.css" />
  <style>
    /* Mobile-first responsive improvements */
    @media (max-width: 768px) {
      .layout {
        flex-direction: column;
      }
      
      .sidenav {
        width: 100%;
        height: auto;
        position: relative;
        border-right: none;
        border-bottom: 1px solid #333;
      }
      
      .sidenav ul {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        padding: 10px;
      }
      
      .sidenav li {
        flex: 1;
        min-width: 120px;
      }
      
      .sidenav a {
        padding: 12px 8px;
        font-size: 0.9em;
        text-align: center;
        border-radius: 8px;
      }
      
      .main {
        margin-left: 0;
        padding: 15px;
      }
      
      .dashboard-stats > div:first-child {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 10px !important;
      }
      
      .dashboard-content {
        grid-template-columns: 1fr !important;
        gap: 15px !important;
      }
      
      #quick-add > div {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 10px !important;
      }
      
      #quick-add button {
        padding: 12px !important;
        font-size: 0.9em !important;
      }
      
      .page-header {
        margin-bottom: 20px !important;
      }
      
      .page-header h1 {
        font-size: 1.5em !important;
      }
      
      /* Touch-friendly buttons */
      button, .btn {
        min-height: 44px;
        min-width: 44px;
      }
      
      /* Larger form inputs */
      input, select, textarea {
        padding: 12px !important;
        font-size: 16px !important; /* Prevents zoom on iOS */
      }
    }
    
    /* Navigation improvements */
    .nav-divider {
      height: 1px;
      background: #333;
      margin: 15px 20px;
    }
    
    .nav-secondary {
      opacity: 0.7;
    }
    
    .nav-secondary a {
      font-size: 0.9em;
      padding: 8px 20px;
    }
    
    /* Quick Add hover effects */
    #quick-add button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.4);
      transition: all 0.3s ease;
    }
    
    /* Dashboard Stats hover effects */
    .dashboard-stats > div > div:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }
    
    /* Card hover effects */
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }
    
    /* Better visual hierarchy */
    .dashboard-stats h3,
    .page-header h1 {
      font-weight: 700;
      letter-spacing: -0.02em;
    }
    
    /* Improved spacing */
    .card, .dashboard-stats, #quick-add {
      margin-bottom: 20px;
    }
    
    /* Better button styling */
    .btn-primary {
      background: linear-gradient(135deg, #7dd3fc, #38bdf8);
      border: none;
      box-shadow: 0 2px 8px rgba(125, 211, 252, 0.3);
    }
    
    .btn-primary:hover {
      background: linear-gradient(135deg, #38bdf8, #0ea5e9);
      transform: translateY(-1px);
    }
    
    /* HIPAA Checkbox Styling */
    .checkbox-container {
      margin: 20px 0;
      padding: 20px;
      background: rgba(125, 211, 252, 0.1);
      border-radius: 12px;
      border: 2px solid rgba(125, 211, 252, 0.3);
      box-shadow: 0 4px 12px rgba(125, 211, 252, 0.1);
    }
    
    .checkbox-container label {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      cursor: pointer;
      color: #e7e7ea;
      font-size: 14px;
      line-height: 1.5;
    }
    
    #hipaa-acknowledge {
      width: 24px;
      height: 24px;
      margin: 0;
      cursor: pointer;
      accent-color: #7dd3fc;
      flex-shrink: 0;
      margin-top: 2px;
      transform: scale(1.2);
      border: 2px solid #7dd3fc;
      border-radius: 4px;
      background: #1a1d29;
    }
    
    #hipaa-acknowledge:checked {
      accent-color: #86efac;
      border-color: #86efac;
      background: #86efac;
    }
    
    /* Light Theme Styles */
    body.light-theme {
      background: #f8fafc;
      color: #1e293b;
    }
    
    body.light-theme .sidenav {
      background: #ffffff;
      border-right: 1px solid #e2e8f0;
    }
    
    body.light-theme .sidenav a {
      color: #475569;
    }
    
    body.light-theme .sidenav a:hover,
    body.light-theme .sidenav a[aria-current="page"] {
      background: #f1f5f9;
      color: #0f172a;
    }
    
    body.light-theme .checkbox-container {
      background: rgba(0, 0, 0, 0.05);
      border-color: rgba(0, 0, 0, 0.1);
    }
    
    body.light-theme .checkbox-container label {
      color: #1e293b;
    }
    
    body.light-theme .brand {
      color: #0f172a;
    }
    
    body.light-theme .main {
      background: #f8fafc;
    }
    
    body.light-theme .dashboard-stats,
    body.light-theme #quick-add,
    body.light-theme .card {
      background: #ffffff;
      border: 1px solid #e2e8f0;
    }
    
    body.light-theme h1,
    body.light-theme h2,
    body.light-theme h3,
    body.light-theme h4 {
      color: #0f172a;
    }
    
    body.light-theme p,
    body.light-theme span,
    body.light-theme div {
      color: #475569;
    }
    
    body.light-theme input,
    body.light-theme select,
    body.light-theme textarea {
      background: #f8fafc;
      color: #0f172a;
      border: 1px solid #cbd5e1;
    }
    
    body.light-theme #theme-toggle {
      background: #f1f5f9;
      color: #475569;
      border: 1px solid #cbd5e1;
    }
    
    body.light-theme #theme-toggle:hover {
      background: #e2e8f0;
    }
    
    body.light-theme #voice-toggle {
      background: #0ea5e9;
      color: #ffffff;
      border: 1px solid #0284c7;
    }
    
    body.light-theme #voice-toggle:hover {
      background: #0284c7;
    }
    
    /* Theme transition */
    body, .sidenav, .main, .dashboard-stats, #quick-add, .card,
    h1, h2, h3, h4, p, span, div, input, select, textarea {
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
    }
    
    /* Header controls positioning */
    .header-controls {
      position: fixed !important;
      top: 20px !important;
      right: 20px !important;
      z-index: 1000 !important;
    }
    
    /* Ensure sidenav doesn't overlap with header controls */
    .sidenav {
      z-index: 100;
    }
    
    /* Safari-specific fixes */
    @supports (-webkit-appearance: none) {
      .sidenav {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
      }
      
      input, select, textarea {
        -webkit-appearance: none;
        border-radius: 8px;
      }
      
      button {
        -webkit-appearance: none;
        -webkit-tap-highlight-color: transparent;
      }
      
      /* Fix Safari flexbox issues */
      .dashboard-stats {
        display: -webkit-flex;
        display: flex;
      }
      
      .dashboard-content {
        display: -webkit-grid;
        display: grid;
      }
    }
  </style>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíä</text></svg>">
</head>

<body>
  <!-- Toast Notifications -->
  <div id="toast-region" aria-live="polite" aria-atomic="true" class="toast-region"></div>
  
  <!-- Voice Command Interface -->
  <div id="voice-interface" style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.95); color: white; padding: 25px; border-radius: 16px; display: none; z-index: 1000; min-width: 450px; text-align: center; box-shadow: 0 8px 32px rgba(0,0,0,0.5);">
            <div id="voice-status" style="font-size: 1.3em; margin-bottom: 15px; font-weight: bold;">üé§ Ready to Record</div>
            <div id="voice-transcript" style="color: #a8aab2; margin-bottom: 20px; font-size: 1.1em; min-height: 20px;">Click "üé§ Record" button above to start recording</div>
    
    <!-- Confirmation Section -->
    <div id="voice-confirmation" style="display: none; margin-bottom: 25px; padding: 20px; background: rgba(255,255,255,0.15); border-radius: 12px; border: 2px solid #fde68a;">
      <div style="font-size: 1.2em; margin-bottom: 15px; color: #fde68a; font-weight: bold;">üìù Confirm Action</div>
      <div id="confirmation-details" style="margin-bottom: 20px; font-size: 1.1em; line-height: 1.4;"></div>
      <div style="display: flex; gap: 15px; justify-content: center; margin-bottom: 10px;">
        <button id="voice-confirm" style="background: #86efac; color: #0b0b0c; padding: 15px 25px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1.1em; min-width: 120px; box-shadow: 0 4px 8px rgba(0,0,0,0.3); transition: all 0.2s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.3)'">‚úÖ YES, LOG IT</button>
        <button id="voice-cancel" style="background: #fda4af; color: #0b0b0c; padding: 15px 25px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1.1em; min-width: 120px; box-shadow: 0 4px 8px rgba(0,0,0,0.3); transition: all 0.2s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.3)'">‚ùå NO, CANCEL</button>
      </div>
      <div style="font-size: 0.9em; color: #a8aab2; margin-top: 10px;">Click a button to confirm or cancel this action</div>
    </div>
    
            <!-- Control Buttons -->
            <div style="display: flex; gap: 15px; justify-content: center;">
              <button id="voice-stop" style="background: #fda4af; color: #0b0b0c; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1em;">‚èπÔ∏è Stop</button>
              <button id="voice-test" style="background: #86efac; color: #0b0b0c; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1em;">üß™ Test</button>
              <button id="voice-help" style="background: #a8aab2; color: #0b0b0c; padding: 8px; border: none; border-radius: 50%; cursor: pointer; font-size: 1.2em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;" title="Voice Commands Help">‚ùì</button>
            </div>
  </div>

  <!-- HIPAA Disclaimer Modal -->
  <div id="hipaa-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>‚ö†Ô∏è Important Privacy Notice</h2>
      </div>
      <div class="modal-body">
        <h3>HIPAA Compliance Disclaimer</h3>
        <p><strong>This application is NOT HIPAA compliant and should not be used to store Protected Health Information (PHI) that requires HIPAA compliance.</strong></p>
        
        <h4>What This Means:</h4>
        <ul>
          <li>This is a personal tracking tool for your own use</li>
          <li>Data is stored locally in your browser only</li>
          <li>We do not transmit your health data to any servers</li>
          <li>This tool is not a substitute for professional medical advice</li>
          <li>Always consult with healthcare professionals about your health</li>
        </ul>

        <h4>Your Privacy:</h4>
        <ul>
          <li>All data is stored locally on your device</li>
          <li>You can export and delete your data at any time</li>
          <li>Clear your browser data to remove all information</li>
          <li>Use the export feature to create backups</li>
        </ul>

        <h4>Security Recommendations:</h4>
        <ul>
          <li>Do not use on shared or public computers</li>
          <li>Keep your device password-protected</li>
          <li>Regularly backup your data using the export feature</li>
          <li>Do not share sensitive health information via unsecured channels</li>
        </ul>

        <div class="checkbox-container">
          <h4 style="color: #7dd3fc; margin: 0 0 15px 0; font-size: 16px;">üìã Please acknowledge:</h4>
          <label style="display: flex; align-items: center; gap: 15px; cursor: pointer; font-size: 15px; line-height: 1.4;">
            <input type="checkbox" id="hipaa-acknowledge" style="width: 24px; height: 24px; cursor: pointer; accent-color: #7dd3fc; transform: scale(1.5); flex-shrink: 0;" />
            <span>I understand that this application is not HIPAA compliant and I agree to use it at my own discretion for personal health tracking only.</span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="hipaa-accept" disabled>Accept & Continue</button>
      </div>
    </div>
  </div>

  <div class="layout">
    <!-- Sidebar Navigation -->
    <!-- Header Controls - Fixed positioning outside all content -->
    <div class="header-controls" style="position: fixed; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 1000;">
      <button id="voice-toggle" style="background: #7dd3fc; color: #0b0b0c; border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 1.2em; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(125, 211, 252, 0.3);" title="Click to Start Voice Recording">
        üé§ Record
      </button>
      <button id="theme-toggle" style="background: #333; color: #e7e7ea; border: 1px solid #555; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 1.2em; transition: all 0.3s ease;" title="Toggle Theme">
        üåô
      </button>
    </div>

    <nav class="sidenav" aria-label="Primary">
      <div class="brand">
        <span class="brand-icon">üíä</span>
        <span>EmberMate</span>
      </div>
      <ul>
        <li><a href="#dashboard" data-nav aria-current="page">üìä Dashboard</a></li>
        <li><a href="#medications" data-nav>üíä Medications</a></li>
        <li><a href="#vitals" data-nav>‚ù§Ô∏è Vitals</a></li>
        <li><a href="#weight" data-nav>‚öñÔ∏è Weight</a></li>
        <li><a href="#alerts" data-nav>üö® Alerts</a></li>
      </ul>
      <div class="nav-divider"></div>
      <ul class="nav-secondary">
        <li><a href="#goals" data-nav>üéØ Goals</a></li>
        <li><a href="#reports" data-nav>üìà Reports</a></li>
        <li><a href="#settings" data-nav>‚öôÔ∏è Settings</a></li>
      </ul>
      <div class="sidenav-footer">
        <button class="btn btn-small" id="quick-export">Quick Export</button>
        <button class="btn btn-small" id="view-hipaa">Privacy Notice</button>
      </div>
    </nav>

    <main id="main" class="main" role="main">
      <div class="loading-overlay" id="loading-overlay" style="display: none; align-items: center; justify-content: center; height: 100vh; background: #f8f9fa;">
        <div style="text-align: center;">
          <div style="font-size: 2em; margin-bottom: 20px;">üíä</div>
          <p style="font-size: 1.2em; color: #666;">Loading EmberMate...</p>
        </div>
      </div>
      <div id="app" style="display: block;">
        <!-- Dashboard Page -->
        <div id="page-dashboard" data-page="dashboard" style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">üìä Dashboard</h1>
            <p id="current-date" style="color: #a8aab2; margin: 0;"></p>
          </div>
          <!-- Alert Notifications -->
          <div id="dashboard-alerts" style="background: #1a1d29; padding: 15px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid #fda4af; display: none;">
            <h4 style="color: #fda4af; margin: 0 0 10px 0;">üö® Health Alerts</h4>
            <div id="alert-notifications">
              <!-- Active alerts will be displayed here -->
            </div>
          </div>
          
          <!-- Quick Add Section -->
          <div id="quick-add" style="background: #121315; padding: 24px; border-radius: 12px; margin-bottom: 24px; border: 1px solid rgba(255, 255, 255, 0.1);">
            <h3 style="color: #e7e7ea; margin: 0 0 20px 0; font-size: 1.1em; font-weight: 600;">‚ö° Quick Add</h3>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;">
              <button id="quick-add-vitals" style="background: linear-gradient(135deg, #86efac, #4ade80); color: #0b0b0c; padding: 16px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 8px; transition: all 0.2s ease; height: 80px; box-shadow: 0 2px 8px rgba(134, 239, 172, 0.2);">
                <span style="font-size: 1.8em;">‚ù§Ô∏è</span>
                <div style="text-align: center;">
                  <div style="font-weight: 600; font-size: 0.9em;">Add Vitals</div>
                  <div style="font-size: 0.75em; opacity: 0.8;">BP, Heart Rate</div>
                </div>
              </button>
              <button id="quick-add-weight" style="background: linear-gradient(135deg, #fde68a, #facc15); color: #0b0b0c; padding: 16px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 8px; transition: all 0.2s ease; height: 80px; box-shadow: 0 2px 8px rgba(253, 230, 138, 0.2);">
                <span style="font-size: 1.8em;">‚öñÔ∏è</span>
                <div style="text-align: center;">
                  <div style="font-weight: 600; font-size: 0.9em;">Add Weight</div>
                  <div style="font-size: 0.75em; opacity: 0.8;">Quick Log</div>
                </div>
              </button>
              <button id="quick-add-med" style="background: linear-gradient(135deg, #7dd3fc, #38bdf8); color: #0b0b0c; padding: 16px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 8px; transition: all 0.2s ease; height: 80px; box-shadow: 0 2px 8px rgba(125, 211, 252, 0.2);">
                <span style="font-size: 1.8em;">üíä</span>
                <div style="text-align: center;">
                  <div style="font-weight: 600; font-size: 0.9em;">Log Meds</div>
                  <div style="font-size: 0.75em; opacity: 0.8;">Taken Today</div>
                </div>
              </button>
              <button id="quick-add-symptom" style="background: linear-gradient(135deg, #c4b5fd, #a78bfa); color: #0b0b0c; padding: 16px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 8px; transition: all 0.2s ease; height: 80px; box-shadow: 0 2px 8px rgba(196, 181, 253, 0.2);">
                <span style="font-size: 1.8em;">üìù</span>
                <div style="text-align: center;">
                  <div style="font-weight: 600; font-size: 0.9em;">Add Symptom</div>
                  <div style="font-size: 0.75em; opacity: 0.8;">Quick Note</div>
                </div>
              </button>
            </div>
          </div>
          
          <div class="dashboard-stats" id="dashboard-stats" style="background: #121315; padding: 24px; border-radius: 12px; margin-bottom: 24px; border: 1px solid rgba(255, 255, 255, 0.1);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h3 style="color: #e7e7ea; margin: 0; font-size: 1.1em; font-weight: 600;">üìä Quick Stats</h3>
              <button id="refresh-data-btn" style="background: linear-gradient(135deg, #7dd3fc, #38bdf8); color: #0b0b0c; padding: 8px 16px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 12px; transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(125, 211, 252, 0.2);">
                üîÑ Refresh Data
              </button>
            </div>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;">
              <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, rgba(125, 211, 252, 0.1), rgba(56, 189, 248, 0.05)); border-radius: 10px; border: 1px solid rgba(125, 211, 252, 0.2);">
                <div style="font-size: 2.5em; color: #7dd3fc; font-weight: bold; margin-bottom: 8px;" id="stat-meds-today">0</div>
                <div style="color: #a8aab2; font-size: 0.85em; font-weight: 500;" id="stat-meds-taken">0 taken</div>
              </div>
              <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, rgba(134, 239, 172, 0.1), rgba(74, 222, 128, 0.05)); border-radius: 10px; border: 1px solid rgba(134, 239, 172, 0.2);">
                <div style="font-size: 2.5em; color: #86efac; font-weight: bold; margin-bottom: 8px;" id="stat-bp-latest">--/--</div>
                <div style="color: #a8aab2; font-size: 0.85em; font-weight: 500;" id="stat-bp-status">Normal</div>
              </div>
              <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, rgba(253, 230, 138, 0.1), rgba(250, 204, 21, 0.05)); border-radius: 10px; border: 1px solid rgba(253, 230, 138, 0.2);">
                <div style="font-size: 2.5em; color: #fde68a; font-weight: bold; margin-bottom: 8px;" id="stat-weight-latest">-- lbs</div>
                <div style="color: #a8aab2; font-size: 0.85em; font-weight: 500;" id="stat-weight-change">+0.0 lbs</div>
              </div>
              <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, rgba(196, 181, 253, 0.1), rgba(167, 139, 250, 0.05)); border-radius: 10px; border: 1px solid rgba(196, 181, 253, 0.2);">
                <div style="font-size: 2.5em; color: #c4b5fd; font-weight: bold; margin-bottom: 8px;" id="stat-goals-progress">0%</div>
                <div style="color: #a8aab2; font-size: 0.85em; font-weight: 500;" id="stat-goals-active">0 active goals</div>
              </div>
            </div>
          </div>
          <div class="dashboard-content" style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
            <div class="card" style="background: #121315; padding: 24px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
              <h3 style="color: #e7e7ea; margin: 0 0 16px 0; font-size: 1.1em; font-weight: 600;">üìà Health Trends</h3>
              <div id="trend-analysis" style="margin-bottom: 16px; color: #a8aab2; font-size: 0.9em;">
                <!-- Trend analysis will be loaded here -->
              </div>
              <canvas id="chart-vitals-mini" width="400" height="200" style="max-width: 100%; border-radius: 8px;"></canvas>
            </div>
            <div class="card" style="background: #121315; padding: 24px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
              <h3 style="color: #e7e7ea; margin: 0 0 16px 0; font-size: 1.1em; font-weight: 600;">üíä Medication Status</h3>
              <div id="medication-status" style="margin-bottom: 16px; color: #a8aab2; font-size: 0.9em;">
                <!-- Medication status will be loaded here -->
              </div>
              <div id="upcoming-meds" style="color: #a8aab2; font-size: 0.9em;">No medications scheduled</div>
            </div>
          </div>
          
          <!-- Advanced Analytics Section -->
          <div id="advanced-analytics" style="background: #121315; padding: 20px; border-radius: 16px; margin-top: 20px;">
            <h3 style="color: #e7e7ea; margin: 0 0 20px 0;">üìä Advanced Analytics</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
              <div>
                <h4 style="color: #e7e7ea; margin: 0 0 10px 0;">‚ù§Ô∏è Blood Pressure Trends</h4>
                <canvas id="bp-trend-chart" width="300" height="200" style="background: #191a1d; border-radius: 8px;"></canvas>
              </div>
              <div>
                <h4 style="color: #e7e7ea; margin: 0 0 10px 0;">‚öñÔ∏è Weight Progress</h4>
                <canvas id="weight-trend-chart" width="300" height="200" style="background: #191a1d; border-radius: 8px;"></canvas>
              </div>
              <div>
                <h4 style="color: #e7e7ea; margin: 0 0 10px 0;">üìÖ Weekly Summary</h4>
                <div id="weekly-summary" style="background: #191a1d; padding: 15px; border-radius: 8px;">
                  <!-- Weekly summary will be loaded here -->
                </div>
              </div>
            </div>
          </div>
          
          <!-- Streaks Section -->
          <div style="background: #121315; padding: 20px; border-radius: 16px; margin-top: 20px;">
            <h3 style="color: #e7e7ea; margin: 0 0 15px 0;">üî• Current Streaks</h3>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
              <div style="text-align: center;">
                <div style="font-size: 1.5em; color: #7dd3fc; font-weight: bold;" id="streak-meds">0 days</div>
                <div style="color: #a8aab2; font-size: 0.9em;">Medication</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 1.5em; color: #86efac; font-weight: bold;" id="streak-vitals">0 days</div>
                <div style="color: #a8aab2; font-size: 0.9em;">Vitals</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 1.5em; color: #fde68a; font-weight: bold;" id="streak-weight">0 weeks</div>
                <div style="color: #a8aab2; font-size: 0.9em;">Weight</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Medications Page -->
        <div id="page-medications" data-page="medications" hidden style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">üíä Medications</h1>
            <button class="btn btn-primary" id="add-medication" style="background: #7dd3fc; color: #0b0b0c; padding: 10px 20px; border: none; border-radius: 8px; font-weight: 600;">Add Medication</button>
          </div>
          <div id="medications-list" style="background: #121315; padding: 20px; border-radius: 16px;">
            <h3 style="color: #e7e7ea; margin: 0 0 15px 0;">Current Medications</h3>
            <div id="medications-table">
              <!-- Medications will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Vitals Page -->
        <div id="page-vitals" data-page="vitals" hidden style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">‚ù§Ô∏è Vitals</h1>
            <button class="btn btn-primary" id="add-vital" style="background: #7dd3fc; color: #0b0b0c; padding: 10px 20px; border: none; border-radius: 8px; font-weight: 600;">Add Vitals</button>
          </div>
          <div id="vitals-list" style="background: #121315; padding: 20px; border-radius: 16px;">
            <h3 style="color: #e7e7ea; margin: 0 0 15px 0;">Recent Vitals</h3>
            <div id="vitals-chart-container">
              <canvas id="chart-vitals" width="800" height="400" style="max-width: 100%;"></canvas>
            </div>
            <div id="vitals-table" style="margin-top: 20px;">
              <table style="width: 100%; color: #e7e7ea;">
                <thead>
                  <tr style="border-bottom: 1px solid #333;">
                    <th style="padding: 10px; text-align: left;">Date</th>
                    <th style="padding: 10px; text-align: left;">Blood Pressure</th>
                    <th style="padding: 10px; text-align: left;">Heart Rate</th>
                    <th style="padding: 10px; text-align: left;">Temperature</th>
                    <th style="padding: 10px; text-align: left;">Notes</th>
                  </tr>
                </thead>
                <tbody id="vitals-tbody">
                  <!-- Vitals data will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Symptoms Page -->
        <div id="page-symptoms" data-page="symptoms" hidden>
          <div class="page-header">
            <h1>üìù Symptoms & Side Effects</h1>
            <button class="btn btn-primary" id="add-symptom">Add Symptom</button>
          </div>
          <div id="symptoms-list"></div>
        </div>

        <!-- Weight Page -->
        <div id="page-weight" data-page="weight" hidden style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">‚öñÔ∏è Weight Tracking</h1>
            <button class="btn btn-primary" id="add-weight" style="background: #7dd3fc; color: #0b0b0c; padding: 10px 20px; border: none; border-radius: 8px; font-weight: 600;">Add Weight</button>
          </div>
          <div id="weight-list" style="background: #121315; padding: 20px; border-radius: 16px;">
            <h3 style="color: #e7e7ea; margin: 0 0 15px 0;">Weight Progress</h3>
            
            <!-- Weight Stats -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px;">
              <div style="text-align: center;">
                <div style="font-size: 1.5em; color: #fde68a; font-weight: bold;" id="weight-current">-- lbs</div>
                <div style="color: #a8aab2; font-size: 0.9em;">Current</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 1.5em; color: #86efac; font-weight: bold;" id="weight-7day">+0.0 lbs</div>
                <div style="color: #a8aab2; font-size: 0.9em;">7 Day</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 1.5em; color: #7dd3fc; font-weight: bold;" id="weight-30day">+0.0 lbs</div>
                <div style="color: #a8aab2; font-size: 0.9em;">30 Day</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 1.5em; color: #c4b5fd; font-weight: bold;" id="weight-bmi">--</div>
                <div style="color: #a8aab2; font-size: 0.9em;">BMI</div>
              </div>
            </div>
            
            <div id="weight-chart-container">
              <canvas id="chart-weight" width="800" height="400" style="max-width: 100%;"></canvas>
            </div>
            <div id="weight-table" style="margin-top: 20px;">
              <table style="width: 100%; color: #e7e7ea;">
                <thead>
                  <tr style="border-bottom: 1px solid #333;">
                    <th style="padding: 10px; text-align: left;">Date</th>
                    <th style="padding: 10px; text-align: left;">Weight</th>
                    <th style="padding: 10px; text-align: left;">Change</th>
                    <th style="padding: 10px; text-align: left;">Notes</th>
                  </tr>
                </thead>
                <tbody id="weight-tbody">
                  <!-- Weight data will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Goals Page -->
        <div id="page-goals" data-page="goals" hidden style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">üéØ Goals & Achievements</h1>
            <button class="btn btn-primary" id="add-goal" style="background: #7dd3fc; color: #0b0b0c; padding: 10px 20px; border: none; border-radius: 8px; font-weight: 600;">Add Goal</button>
          </div>
          <div id="goals-list" style="background: #121315; padding: 20px; border-radius: 16px;">
            <h3 style="color: #e7e7ea; margin: 0 0 15px 0;">Current Goals</h3>
            <div id="goals-table">
              <!-- Goals will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Bulk Entry Page -->
        <div id="page-bulk-entry" data-page="bulk-entry" hidden style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">üìã Bulk Data Entry</h1>
          </div>
          <div id="bulk-entry-content" style="background: #121315; padding: 20px; border-radius: 16px;">
            <h3 style="color: #e7e7ea; margin: 0 0 15px 0;">Bulk Data Entry</h3>
            
            <!-- Vitals Bulk Entry -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">‚ù§Ô∏è Bulk Vitals Entry</h4>
              <table style="width: 100%; color: #e7e7ea; margin-bottom: 15px;">
                <thead>
                  <tr style="border-bottom: 1px solid #333;">
                    <th style="padding: 8px;">Date</th>
                    <th style="padding: 8px;">Systolic</th>
                    <th style="padding: 8px;">Diastolic</th>
                    <th style="padding: 8px;">Heart Rate</th>
                    <th style="padding: 8px;">Temperature</th>
                    <th style="padding: 8px;">Notes</th>
                  </tr>
                </thead>
                <tbody id="bulk-vitals-tbody">
                  <!-- Bulk vitals rows will be added here -->
                </tbody>
              </table>
              <div style="display: flex; gap: 10px;">
                <button id="bulk-vitals-add-row" style="background: #7dd3fc; color: #0b0b0c; padding: 8px 16px; border: none; border-radius: 6px; font-weight: 600;">Add Row</button>
                <button id="bulk-vitals-save" style="background: #86efac; color: #0b0b0c; padding: 8px 16px; border: none; border-radius: 6px; font-weight: 600;">Save All</button>
                <button id="bulk-vitals-clear" style="background: #fda4af; color: #0b0b0c; padding: 8px 16px; border: none; border-radius: 6px; font-weight: 600;">Clear</button>
              </div>
            </div>
            
            <!-- Weight Bulk Entry -->
            <div>
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">‚öñÔ∏è Bulk Weight Entry</h4>
              <table style="width: 100%; color: #e7e7ea; margin-bottom: 15px;">
                <thead>
                  <tr style="border-bottom: 1px solid #333;">
                    <th style="padding: 8px;">Date</th>
                    <th style="padding: 8px;">Weight (lbs)</th>
                    <th style="padding: 8px;">Notes</th>
                  </tr>
                </thead>
                <tbody id="bulk-weight-tbody">
                  <!-- Bulk weight rows will be added here -->
                </tbody>
              </table>
              <div style="display: flex; gap: 10px;">
                <button id="bulk-weight-add-row" style="background: #7dd3fc; color: #0b0b0c; padding: 8px 16px; border: none; border-radius: 6px; font-weight: 600;">Add Row</button>
                <button id="bulk-weight-save" style="background: #86efac; color: #0b0b0c; padding: 8px 16px; border: none; border-radius: 6px; font-weight: 600;">Save All</button>
                <button id="bulk-weight-clear" style="background: #fda4af; color: #0b0b0c; padding: 8px 16px; border: none; border-radius: 6px; font-weight: 600;">Clear</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Reports Page -->
        <div id="page-reports" data-page="reports" hidden style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">üìà Reports & Export</h1>
          </div>
          <div id="reports-content" style="background: #121315; padding: 20px; border-radius: 16px;">
            <h3 style="color: #e7e7ea; margin: 0 0 15px 0;">Generate Reports</h3>
            
            <!-- Report Options -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">Select Data to Include:</h4>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="report-medications" checked style="margin-right: 8px;">
                  üíä Medications
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="report-vitals" checked style="margin-right: 8px;">
                  ‚ù§Ô∏è Vitals
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="report-weight" checked style="margin-right: 8px;">
                  ‚öñÔ∏è Weight Tracking
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="report-goals" checked style="margin-right: 8px;">
                  üéØ Goals & Achievements
                </label>
              </div>
            </div>
            
            <!-- Date Range -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">Date Range:</h4>
              <div style="display: flex; gap: 15px; align-items: center;">
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">From:</label>
                  <input type="date" id="report-date-from" style="background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 8px; border-radius: 6px;">
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">To:</label>
                  <input type="date" id="report-date-to" style="background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 8px; border-radius: 6px;">
                </div>
              </div>
            </div>
            
            <!-- Export Buttons -->
            <div style="display: flex; gap: 15px; margin-bottom: 30px;">
              <button id="generate-report" style="background: #7dd3fc; color: #0b0b0c; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                üìä Generate Report
              </button>
              <button id="export-json" style="background: #86efac; color: #0b0b0c; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                üìÑ Export JSON
              </button>
              <button id="export-csv" style="background: #fde68a; color: #0b0b0c; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                üìã Export CSV
              </button>
            </div>
            
            <!-- Report Preview -->
            <div id="report-preview" style="background: #191a1d; padding: 20px; border-radius: 8px; border: 1px solid #333;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">Report Preview</h4>
              <div id="report-content" style="color: #a8aab2;">
                Click "Generate Report" to see your health data summary here.
              </div>
            </div>
          </div>
        </div>

        <!-- Alerts Page -->
        <div id="page-alerts" data-page="alerts" hidden style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">üö® Health Alerts</h1>
            <button class="btn btn-primary" id="add-alert" style="background: #7dd3fc; color: #0b0b0c; padding: 10px 20px; border: none; border-radius: 8px; font-weight: 600;">Add Alert</button>
          </div>
          
          <!-- Active Alerts -->
          <div id="active-alerts" style="background: #121315; padding: 20px; border-radius: 16px; margin-bottom: 20px;">
            <h3 style="color: #e7e7ea; margin: 0 0 15px 0;">üîî Active Alerts</h3>
            <div id="alerts-list">
              <!-- Active alerts will be displayed here -->
            </div>
          </div>
          
          <!-- Alert Configuration -->
          <div id="alert-config" style="background: #121315; padding: 20px; border-radius: 16px;">
            <h3 style="color: #e7e7ea; margin: 0 0 20px 0;">‚öôÔ∏è Alert Configuration</h3>
            
            <!-- Blood Pressure Alerts -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">‚ù§Ô∏è Blood Pressure Alerts</h4>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">High Systolic Threshold:</label>
                  <input type="number" id="bp-systolic-high" placeholder="140" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">High Diastolic Threshold:</label>
                  <input type="number" id="bp-diastolic-high" placeholder="90" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Low Systolic Threshold:</label>
                  <input type="number" id="bp-systolic-low" placeholder="90" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Low Diastolic Threshold:</label>
                  <input type="number" id="bp-diastolic-low" placeholder="60" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
              </div>
            </div>
            
            <!-- Weight Alerts -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">‚öñÔ∏è Weight Change Alerts</h4>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Weight Gain Alert (lbs):</label>
                  <input type="number" id="weight-gain-threshold" placeholder="5" step="0.1" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Weight Loss Alert (lbs):</label>
                  <input type="number" id="weight-loss-threshold" placeholder="5" step="0.1" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Time Period (days):</label>
                  <select id="weight-timeframe" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                    <option value="7">7 days</option>
                    <option value="14">14 days</option>
                    <option value="30" selected>30 days</option>
                    <option value="90">90 days</option>
                  </select>
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Alert Frequency:</label>
                  <select id="weight-alert-frequency" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                    <option value="immediate">Immediate</option>
                    <option value="daily" selected>Daily</option>
                    <option value="weekly">Weekly</option>
                  </select>
                </div>
              </div>
            </div>
            
            <!-- Medication Alerts -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">üíä Medication Alerts</h4>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Missed Dose Alert:</label>
                  <select id="med-missed-alert" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                    <option value="disabled">Disabled</option>
                    <option value="1hour">1 hour after missed</option>
                    <option value="2hours" selected>2 hours after missed</option>
                    <option value="4hours">4 hours after missed</option>
                  </select>
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Refill Reminder (days before):</label>
                  <input type="number" id="med-refill-reminder" placeholder="7" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
              </div>
            </div>
            
            <!-- Alert Settings -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">üîî Alert Settings</h4>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="alert-sound" checked style="margin-right: 8px;">
                  üîä Sound Alerts
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="alert-visual" checked style="margin-right: 8px;">
                  üëÅÔ∏è Visual Alerts
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="alert-dashboard" checked style="margin-right: 8px;">
                  üìä Show on Dashboard
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="alert-email" style="margin-right: 8px;">
                  üìß Email Notifications
                </label>
              </div>
            </div>
            
            <!-- Save Button -->
            <div style="display: flex; gap: 15px;">
              <button id="save-alert-settings" style="background: #86efac; color: #0b0b0c; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                üíæ Save Alert Settings
              </button>
              <button id="test-alerts" style="background: #fde68a; color: #0b0b0c; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                üß™ Test Alerts
              </button>
              <button id="clear-alerts" style="background: #fda4af; color: #0b0b0c; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                üóëÔ∏è Clear All Alerts
              </button>
            </div>
          </div>
        </div>

        <!-- Settings Page -->
        <div id="page-settings" data-page="settings" hidden style="padding: 20px; color: #e7e7ea;">
          <div class="page-header" style="margin-bottom: 30px;">
            <h1 style="color: #e7e7ea; margin: 0 0 10px 0;">‚öôÔ∏è Settings</h1>
          </div>
          <div id="settings-content" style="background: #121315; padding: 20px; border-radius: 16px;">
            <div style="background: #1a1d29; padding: 15px; border-radius: 8px; border-left: 4px solid #7dd3fc; margin-bottom: 20px;">
              <h4 style="color: #7dd3fc; margin: 0 0 8px 0;">üîí HIPAA Compliant</h4>
              <p style="color: #a8aab2; margin: 0; font-size: 0.9em;">This app stores only de-identified health data. No personally identifiable information (PII) such as names, birth dates, or specific identifiers are collected or stored.</p>
            </div>
            <h3 style="color: #e7e7ea; margin: 0 0 20px 0;">Health Settings</h3>
            
            <!-- Health Info (De-identified) -->
            <div style="margin-bottom: 30px;">
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Height (inches):</label>
                  <input type="number" id="setting-height" placeholder="70" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Age Range:</label>
                  <select id="setting-age-range" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                    <option value="">Select Age Range</option>
                    <option value="18-25">18-25</option>
                    <option value="26-35">26-35</option>
                    <option value="36-45">36-45</option>
                    <option value="46-55">46-55</option>
                    <option value="56-65">56-65</option>
                    <option value="65+">65+</option>
                  </select>
                </div>
              </div>
            </div>
            
            <!-- Weight Goals -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">Weight Goals</h4>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Target Weight (lbs):</label>
                  <input type="number" id="setting-target-weight" placeholder="175" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
                <div>
                  <label style="color: #a8aab2; display: block; margin-bottom: 5px;">Target Date:</label>
                  <input type="date" id="setting-target-date" style="width: 100%; background: #191a1d; color: #e7e7ea; border: 1px solid #333; padding: 10px; border-radius: 6px;">
                </div>
              </div>
              <button id="save-weight-goal" style="background: #7dd3fc; color: #0b0b0c; padding: 10px 20px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; margin-top: 15px;">
                üíæ Save Weight Goal
              </button>
            </div>
            
            <!-- Notifications -->
            <div style="margin-bottom: 30px;">
              <h4 style="color: #e7e7ea; margin: 0 0 15px 0;">Notifications</h4>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="notify-meds" checked style="margin-right: 8px;">
                  üíä Medication Reminders
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="notify-vitals" checked style="margin-right: 8px;">
                  ‚ù§Ô∏è Vitals Tracking
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="notify-weight" style="margin-right: 8px;">
                  ‚öñÔ∏è Weight Tracking
                </label>
                <label style="display: flex; align-items: center; color: #a8aab2;">
                  <input type="checkbox" id="notify-goals" checked style="margin-right: 8px;">
                  üéØ Goal Updates
                </label>
              </div>
            </div>
            
            <!-- Save Settings -->
            <div style="display: flex; gap: 15px;">
              <button id="save-settings" style="background: #86efac; color: #0b0b0c; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                üíæ Save All Settings
              </button>
              <button id="reset-settings" style="background: #fda4af; color: #0b0b0c; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                üîÑ Reset to Defaults
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Load external JS modules -->
<script src="js/store.js"></script>
<script>
  // Bypass HIPAA modal for testing
  window.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, bypassing HIPAA check');
    const data = localStorage.getItem('healthTrackerData');
    if (data) {
      const parsed = JSON.parse(data);
      parsed.hipaaAccepted = true;
      localStorage.setItem('healthTrackerData', JSON.stringify(parsed));
    } else {
      // Create default data with HIPAA accepted
      const defaultData = {
        medications: [],
        vitals: [],
        symptoms: [],
        weights: [],
        goals: [],
        medicationLog: [],
        achievements: [],
        settings: {
          height: '',
          ageRange: '',
          targetWeight: '',
          targetDate: '',
          notifications: {
            meds: true,
            vitals: true,
            weight: false,
            goals: true
          }
        },
        hipaaAccepted: true
      };
      localStorage.setItem('healthTrackerData', JSON.stringify(defaultData));
    }
    
    // Force dashboard update after a delay to ensure all scripts are loaded
    setTimeout(() => {
      console.log('Attempting to refresh dashboard...');
      
      // Manual dashboard population as fallback
      const healthData = localStorage.getItem('healthTrackerData');
      if (healthData) {
        try {
          const data = JSON.parse(healthData);
          console.log('Found health data:', data);
          
          // Update dashboard stats manually
          const medsCount = data.medications ? data.medications.length : 0;
          const vitalsCount = data.vitals ? data.vitals.length : 0;
          const weightsCount = data.weights ? data.weights.length : 0;
          const goalsCount = data.goals ? data.goals.length : 0;
          
          // Update medication count
          const medsElement = document.getElementById('stat-meds-today');
          if (medsElement) {
            medsElement.textContent = medsCount;
            console.log('Updated medications count:', medsCount);
          }
          
          // Update blood pressure
          if (data.vitals && data.vitals.length > 0) {
            const latestVital = data.vitals[0];
            const bpElement = document.getElementById('stat-bp-latest');
            if (bpElement) {
              bpElement.textContent = `${latestVital.systolic}/${latestVital.diastolic}`;
              console.log('Updated BP:', `${latestVital.systolic}/${latestVital.diastolic}`);
            }
          }
          
          // Update weight
          if (data.weights && data.weights.length > 0) {
            const latestWeight = data.weights[0];
            const weightElement = document.getElementById('stat-weight-latest');
            if (weightElement) {
              weightElement.textContent = `${latestWeight.value} lbs`;
              console.log('Updated weight:', `${latestWeight.value} lbs`);
            }
          }
          
          // Update goals
          const goalsElement = document.getElementById('stat-goals-active');
          if (goalsElement) {
            goalsElement.textContent = goalsCount;
            console.log('Updated goals count:', goalsCount);
          }
          
          // Update current date
          const dateElement = document.getElementById('current-date');
          if (dateElement) {
            dateElement.textContent = new Date().toLocaleDateString('en-US', { 
              weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
            });
          }
          
        } catch (error) {
          console.error('Error parsing health data:', error);
        }
      } else {
        console.log('No health data found in localStorage');
      }
      
      // Try calling the original functions as well
      if (typeof window.loadDashboard === 'function') {
        console.log('Calling loadDashboard...');
        window.loadDashboard();
      }
      if (typeof window.updateDashboardStats === 'function') {
        console.log('Calling updateDashboardStats...');
        window.updateDashboardStats();
      }
    }, 2000);
    
    // Add refresh button functionality
    const refreshBtn = document.getElementById('refresh-data-btn');
    if (refreshBtn) {
      refreshBtn.addEventListener('click', function() {
        console.log('Refresh button clicked - reloading sample data...');
        
        // Clear existing data and force reload
        localStorage.removeItem('sampleDataLoaded');
        localStorage.removeItem('sampleDataVersion');
        
        // Reload the page to trigger fresh data loading
        window.location.reload();
      });
    }
  });
</script>
<script src="js/consent.js"></script>
<script src="js/nav.js"></script>
<script src="js/telemetry.js"></script>
<script src="js/sampling.js"></script>
<script src="js/app.js"></script>
<script src="js/app-enhanced.js"></script>

  <!-- Sample Data Auto-Loader -->
  <script>
  (async function() {
    const SAMPLE_DATA_LOADED_KEY = 'sampleDataLoaded';
    const SAMPLE_DATA_VERSION_KEY = 'sampleDataVersion';
    const CURRENT_VERSION = '3.0.0'; // HIPAA compliant version - removed PII

    // Check if sample data has already been loaded
    const hasLoadedSampleData = localStorage.getItem(SAMPLE_DATA_LOADED_KEY);
    const loadedVersion = localStorage.getItem(SAMPLE_DATA_VERSION_KEY);

    // Only load sample data if:
    // 1. Never loaded before, OR
    // 2. Version has changed
    if (hasLoadedSampleData === 'true' && loadedVersion === CURRENT_VERSION) {
      console.log('Sample data already loaded (version ' + CURRENT_VERSION + ')');
      return;
    }

    // Check if user already has data (don't overwrite existing data)
    const hasExistingData = localStorage.getItem('healthTrackerData');

    if (hasExistingData && hasLoadedSampleData !== 'true') {
      console.log('User has existing data, skipping sample data load');
      localStorage.setItem(SAMPLE_DATA_LOADED_KEY, 'true');
      localStorage.setItem(SAMPLE_DATA_VERSION_KEY, CURRENT_VERSION);
      return;
    }

    try {
      // Fetch sample data from sample-data.json
      const response = await fetch('sample-data.json');
      
      if (!response.ok) {
        console.warn('Sample data file not found or could not be loaded');
        return;
      }

      const sampleData = await response.json();
      console.log('Loading sample data...');

      // Transform sample data to match app's expected structure
      const transformedData = {
        medications: sampleData.medications || [],
        vitals: [], // Will be populated from blood_pressure data
        symptoms: sampleData.symptoms || [],
        weights: [], // Will be populated from weight data
        goals: sampleData.goals || [],
        medicationLog: [],
        achievements: sampleData.achievements || [],
        settings: {
          height: '70',
          targetWeight: '175',
          targetDate: '2025-12-22',
          notifications: {
            meds: true,
            vitals: true,
            weight: false,
            goals: true
          }
        },
        hipaaAccepted: true
      };

      // Transform blood pressure data to vitals format
      if (sampleData.vitals && sampleData.vitals.blood_pressure) {
        transformedData.vitals = sampleData.vitals.blood_pressure.map((bp, index) => ({
          id: `vital-${index}`,
          date: bp.date,
          systolic: bp.systolic,
          diastolic: bp.diastolic,
          heartRate: sampleData.vitals.heart_rate ? sampleData.vitals.heart_rate[index]?.bpm : null,
          temperature: 98.6,
          notes: bp.notes || ''
        }));
        console.log('‚úì Loaded ' + transformedData.vitals.length + ' sample vitals entries');
      }

      // Transform weight data
      if (sampleData.vitals && sampleData.vitals.weight) {
        transformedData.weights = sampleData.vitals.weight.map((w, index) => ({
          id: `weight-${index}`,
          date: w.date,
          value: w.pounds,
          notes: w.notes || ''
        }));
        console.log('‚úì Loaded ' + transformedData.weights.length + ' sample weight entries');
      }

      // Store transformed data in the correct format
      localStorage.setItem('healthTrackerData', JSON.stringify(transformedData));
      console.log('‚úì Loaded ' + transformedData.medications.length + ' sample medications');
      console.log('‚úì Loaded ' + transformedData.goals.length + ' sample goals');
      console.log('‚úì Transformed data structure:', transformedData);

      // Mark sample data as loaded with version
      localStorage.setItem(SAMPLE_DATA_LOADED_KEY, 'true');
      localStorage.setItem(SAMPLE_DATA_VERSION_KEY, CURRENT_VERSION);

      console.log('‚úì Sample data loaded successfully!');
      
      // Force dashboard refresh after data is loaded
      setTimeout(() => {
        if (typeof loadDashboard === 'function') {
          console.log('Refreshing dashboard with new data...');
          loadDashboard();
        }
        if (typeof updateDashboardStats === 'function') {
          console.log('Updating dashboard stats...');
          updateDashboardStats();
        }
      }, 500);
      
      // Show success notification if toast function is available
      if (typeof showToast === 'function') {
        showToast('‚úì Sample data loaded successfully! Explore the app to see example entries.', 'success');
      }

    } catch (error) {
      console.error('Error loading sample data:', error);
      // Don't block app loading if sample data fails
    }
  })();
  </script>

  <!-- Quick Export Utility -->
  <script>
  (function() {
    const quickExportBtn = document.getElementById('quick-export');
    const viewHipaaBtn = document.getElementById('view-hipaa');
    
    if (quickExportBtn) {
      quickExportBtn.addEventListener('click', function() {
        const data = {
          medications: JSON.parse(localStorage.getItem('medications') || '[]'),
          vitals: JSON.parse(localStorage.getItem('vitals') || '[]'),
          appointments: JSON.parse(localStorage.getItem('appointments') || '[]'),
          symptoms: JSON.parse(localStorage.getItem('symptoms') || '[]'),
          notes: JSON.parse(localStorage.getItem('notes') || '[]'),
          weight: JSON.parse(localStorage.getItem('weight') || '[]'),
          goals: JSON.parse(localStorage.getItem('goals') || '[]'),
          exportDate: new Date().toISOString()
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'healthtracker-backup-' + new Date().toISOString().split('T')[0] + '.json';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        if (typeof showToast === 'function') {
          showToast('‚úì Data exported successfully', 'success');
        }
      });
    }

    if (viewHipaaBtn) {
      viewHipaaBtn.addEventListener('click', function() {
        const modal = document.getElementById('hipaa-modal');
        if (modal) {
          modal.style.display = 'flex';
          
          // Reset checkbox state
          const checkbox = document.getElementById('hipaa-acknowledge');
          const acceptBtn = document.getElementById('hipaa-accept');
          if (checkbox) checkbox.checked = false;
          if (acceptBtn) acceptBtn.disabled = true;
        }
      });
    }
  })();
  </script>

  <!-- Import Data Utility -->
  <script>
  function importData() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'flex';
    modal.innerHTML = 
      '<div class="modal-content">' +
      '<div class="modal-header">' +
      '<h2>üì• Import Backup Data</h2>' +
      '</div>' +
      '<div class="modal-body">' +
      '<p>Select a backup JSON file to import your health data.</p>' +
      '<p><strong>Warning:</strong> This will overwrite your current data.</p>' +
      '<input type="file" id="import-file-input" accept=".json" />' +
      '</div>' +
      '<div class="modal-footer">' +
      '<button class="btn btn-secondary" onclick="this.closest(\'.modal\').remove()">Cancel</button>' +
      '<button class="btn btn-primary" id="import-confirm-btn">Import</button>' +
      '</div>' +
      '</div>';
    
    document.body.appendChild(modal);
    
    const fileInput = document.getElementById('import-file-input');
    const confirmBtn = document.getElementById('import-confirm-btn');
    
    confirmBtn.onclick = function() {
      const file = fileInput.files[0];
      if (!file) {
        if (typeof showToast === 'function') {
          showToast('Please select a file', 'error');
        }
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const data = JSON.parse(e.target.result);
          
          // Import each data type
          if (data.medications) localStorage.setItem('medications', JSON.stringify(data.medications));
          if (data.vitals) localStorage.setItem('vitals', JSON.stringify(data.vitals));
          if (data.appointments) localStorage.setItem('appointments', JSON.stringify(data.appointments));
          if (data.symptoms) localStorage.setItem('symptoms', JSON.stringify(data.symptoms));
          if (data.notes) localStorage.setItem('notes', JSON.stringify(data.notes));
          if (data.weight) localStorage.setItem('weight', JSON.stringify(data.weight));
          if (data.goals) localStorage.setItem('goals', JSON.stringify(data.goals));
          
          if (typeof showToast === 'function') {
            showToast('‚úì Data imported successfully! Refreshing...', 'success');
          }
          
          setTimeout(() => window.location.reload(), 1500);
        } catch (err) {
          console.error('Import error:', err);
          if (typeof showToast === 'function') {
            showToast('‚ùå Invalid JSON file', 'error');
          }
        }
      };
      reader.readAsText(file);
      modal.remove();
    };
    
    modal.onclick = function(e) {
      if (e.target === modal) modal.remove();
    };
  }

  // Add CSS animation
  const style = document.createElement('style');
  style.textContent = 
    '@keyframes slideIn {' +
    'from { transform: translateX(400px); opacity: 0; }' +
    'to { transform: translateX(0); opacity: 1; }' +
    '}' +
    '@keyframes slideInRight {' +
    'from { transform: translateX(100%); opacity: 0; }' +
    'to { transform: translateX(0); opacity: 1; }' +
    '}' +
    '@keyframes slideOutRight {' +
    'from { transform: translateX(0); opacity: 1; }' +
    'to { transform: translateX(100%); opacity: 0; }' +
    '}' +
    '@keyframes bounceIn {' +
    '0% { transform: translate(-50%, -50%) scale(0.3); opacity: 0; }' +
    '50% { transform: translate(-50%, -50%) scale(1.05); }' +
    '70% { transform: translate(-50%, -50%) scale(0.9); }' +
    '100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }' +
    '}' +
    '@keyframes bounceOut {' +
    '0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }' +
    '100% { transform: translate(-50%, -50%) scale(0.3); opacity: 0; }' +
    '}';
  document.head.appendChild(style);
  </script>

</body>
</html>
